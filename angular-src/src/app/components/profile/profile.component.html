<div class="container-fluid">
    <div class="row align-start">
        <div class="fb-profile ">
            <img align="left" class="fb-image-lg" src="https://picsum.photos/seed/picsum/800/200" alt="Profile image example"/>
            <img align="left" class="fb-image-profile thumbnail" src="https://i.pravatar.cc/300" alt="Profile image example"/>
          <div class="fb-profile-text">
          <div *ngIf="user">
            <div>
              <div> <strong> {{user.username}} </strong></div>
              <div> <strong> {{user.email}} </strong></div>
              <div> <strong> {{user.score}} </strong></div>
            </div>
          </div>
          </div>
        </div>
    </div> <br>
      <p class="text-center"> <strong>Table des Consentements </strong> </p>
      <div class="card m-2" *ngFor="let procPurp of procPurposes " style="border: 1px solid black">
        <div class="card-title m-1"> {{procPurp.ProcPurpValue}} </div>
          <div class="row m-2" *ngIf="procPurp.currentConsent != undefined">
              <div class="col-lg" *ngIf="procPurp.currentConsent.EndDate != undefined" ><label class="small" for="startEndDate1">Validity Period: </label>
                <p id="startEndDate1"> {{ ( procPurp.currentConsent.StartDate | date :'dd/MM/yyyy' ) + ' - ' +  ( procPurp.currentConsent.EndDate | date :'dd/MM/yyyy' )}}</p>
              </div>
              <div class="col-lg" *ngIf="procPurp.currentConsent.EndDate == undefined"><label class="small" for="startEndDate1">Validity Period: </label>
                <p id="startEndDate1"> {{ ( procPurp.currentConsent.StartDate | date :'dd/MM/yyyy' ) + ' - ' + ("No EndDate")}}</p>
              </div>
              <div class="col-lg"><label class="small" for="SubmittedVia1">SubmittedVia: </label>
                <p id="SubmittedVia1"> CEAN Auth </p>
              </div>
              <div class="col-lg"><label class="small" for="Soumis">Soumis dans: </label>
                <p id="Soumis"> {{procPurp.currentConsent.LanguageAgreedInValue}}</p>
              </div>
              <div class="col-lg"><label class="small" for="Accept">Accordé le: </label>
                <p id="Accept"> {{procPurp.currentConsent.StartDate | date :'dd/MM/yyyy'}}</p>
              </div>
              <div class="col-lg"><label class="small" for="EndReason1">EndReason:</label>
                <p id="EndReason1">{{ procPurp.currentConsent.EndReasonValue }}</p>
              </div>
              <div class="col-lg"><label class="small" for="Maj"> Dernière MAJ le: </label>
                <p id="Maj"> {{procPurp.currentConsent.ConsentLastUpdateDate | date :'dd/MM/yyyy'}} </p>
              </div>
              <div class="col-lg custom-control custom-switch"> <span class="small"> Activate consent: </span>
                <input (click)="withdrawConsent(procPurp.currentConsent)"
                  type="checkbox" class="custom-control-input" name="{{'AgreeInd-' + procPurp.currentConsent.ProcPurpId}}"
                  id="{{'AgreeInd-' + procPurp.currentConsent.ProcPurpId}}" checked
                  *ngIf="(procPurp.currentConsent.AgreeInd === '1') ? true : false">

                <input (click)="addConsent(procPurp.ProcPurpId)"
                  type="checkbox" class="custom-control-input" name="{{'AgreeInd-' + procPurp.currentConsent.ProcPurpId}}"
                  id="{{'AgreeInd-' + procPurp.currentConsent.ProcPurpId}}"
                  *ngIf="(procPurp.currentConsent.AgreeInd === '0') ? true : false">
                <label class="custom-control-label" for="{{'AgreeInd-' + procPurp.currentConsent.ProcPurpId}}"> On/Off </label>
              </div>
              <div class="col-lg-1">
                  <a class="btn btn-primary" data-toggle="collapse" href="#{{'collapse'+procPurp.ProcPurpId}}" role="button" >
                      History</a>
              </div>
            </div><!-- End of row-->
            <div class="row m-2" *ngIf="procPurp.currentConsent === undefined">
              <div class="col-lg-9"> No consent </div>
              <div class="col-lg-2 custom-control custom-switch"> <label class="small" for="toggle"> Activate consent: </label>
                <input (click)="addConsent(procPurp.ProcPurpId)"
                  type="checkbox" class="custom-control-input" name="{{'AgreeInd-' + procPurp.ProcPurpId}}" id="{{'AgreeInd-' + procPurp.ProcPurpId}}">
                <label class="custom-control-label" for="{{'AgreeInd-' + procPurp.ProcPurpId}}">On/Off </label>
              </div>
              <div class="col-lg-1">
                  <a class="btn btn-primary" data-toggle="collapse" href="#{{'collapse'+procPurp.ProcPurpId}}" role="button" >
                    History</a>
              </div>
            </div><!-- End of row-->
            <div class="card m-1" style="border: 1px solid black">
                <div class="collapse" id="{{'collapse'+procPurp.ProcPurpId}}">
                    <div class="row" *ngFor="let historicalConsent of procPurp.historicalConsents">
                      <div class="col-sm m-2"><label class="small" for="startEndDate-hist1">Validity Period</label>
                        <p id="startEndDate-hist1">{{ ( historicalConsent.StartDate | date :'dd/MM/yyyy' ) + ' - ' +  ( historicalConsent.EndDate | date :'dd/MM/yyyy' )}}</p>
                      </div>
                      <div class="col-sm m-2">
                        <label class="small" for="SubmittedVia-hist1">SubmittedVia</label>
                        <p id="SubmittedVia-hist1">iPhone</p>
                      </div>
                      <div class="col-sm m-2">
                        <label class="small" for="EndReason-hist1">End Reason</label>
                        <p id="EndReason-hist1">{{ historicalConsent.EndReasonValue }}</p>
                      </div>
                    </div>
                </div>
            </div>
        </div><!-- End of card-->
</div>

